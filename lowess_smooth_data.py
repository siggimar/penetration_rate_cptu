from statsmodels.nonparametric.smoothers_lowess import lowess as sm_lowess
from smoothers import lowess
import numpy as np
import matplotlib.pyplot as plt




def ex():
    frac = 0.5
    it = 2

    bemben_x = np.array([0.020375174,0.040863326,0.07612217,0.197667782,0.200819004,0.201880535,0.77437708,2.053694195,2.053694195,2.053694195,2.053694195,5.139643877,5.139643877,10.4721136,10.4721136,20.67272964])
    bemben_y = np.array([4.941215537,5.013330047,4.854517912,3.84365366,3.590847518,3.529059898,3.920262459,5.596030478,5.225092429,5.107066686,4.8710152,5.675251562,5.371756795,5.769953331,5.685649229,5.892544139])

    roy_x = np.array([0.049501477,0.049501477,0.049899294,0.049699988,0.049699988,0.049699988,0.049699988,0.049501477,0.049501477,0.049501477,0.098926674,0.100121599,0.099323389,0.099323389,0.098926674,0.100523106,0.099721695,0.099323389,0.098926674,0.098926674,0.24736801,0.24736801,0.246379978,0.248360004,0.246379978,0.246379978,0.246379978,0.24736801,0.246379978,0.24736801,0.488454838,0.486503863,0.486503863,0.490413638,0.486503863,0.490413638,0.490413638,0.486503863,0.494354833,0.492380292,0.490413638,0.999881198,0.98794788,0.976156982,0.968374666,0.976156982,0.98400184,0.98400184,0.98400184,0.98794788,0.98400184,1.958632863,1.974373361,1.974373361,1.974373361,1.958632863,1.982290983,1.958632863,1.958632863,1.958632863,3.898613329,3.929944426,3.929944426,3.898613329,3.929944426,3.914247529,3.867532017,3.867532017,3.867532017,3.929944426])
    roy_y = np.array([4.719363146,4.580768343,4.471057495,4.445065951,4.416192033,4.355556807,4.303583756,4.27470482,4.237168728,4.153434368,4.454591332,4.295799843,4.073460643,4.035924551,3.955072564,3.937768288,3.931983467,3.91754149,3.683657742,3.672108175,4.123690553,4.115028378,4.008189865,3.996650336,3.979315948,3.967766381,3.918680722,3.846500947,3.811847228,3.693469186,4.79153121,4.759764882,4.736665748,4.725126219,4.707791831,4.624067509,4.615405333,4.592296162,4.574991887,4.413292931,4.297792244,4.96567305,4.870374067,4.737538992,4.754853305,4.777962476,4.668251628,4.645152494,4.627828144,4.509450102,4.474796383,5.001164882,4.859692725,4.830818808,4.801944891,4.773060936,4.715328158,4.640240917,4.605592216,4.585380474,5.056888532,4.981826384,4.952952467,4.929843296,4.889429849,4.866325696,4.785463672,4.773914105,4.750814972,4.566041976])
    
    x_pred = np.logspace(-2,2,1000)
    x_pred = np.array([x for x in x_pred if x>=0.02 and x<=25])

    roy_pred_y = sm_lowess( roy_y, roy_x, frac=frac, it=it, xvals=x_pred )
    bemben_pred_y = sm_lowess( bemben_y, bemben_x, frac=frac, it=it, xvals=x_pred )

    fig, ax = plt.subplots()
    ax.scatter( bemben_x,bemben_y )
    ax.scatter( roy_x,roy_y )
    ax.plot(x_pred,bemben_pred_y)
    ax.plot(x_pred,roy_pred_y)

    ax.set_xscale('log')
    
    plt.show()

if __name__=='__main__':
    ex()